import requests
from bs4 import BeautifulSoup
from util import format_text, save_text


def scrapy(url: str):
    res = ''
    if url in [
        'https://wordpress.org/plugins/print-my-blog/#developers',
        'https://wordpress.org/plugins/google-calendar-events/changelog',
        'https://wordpress.org/plugins/quiz-master-next/#developers',
        'http://typo3.org/extensions/repository/view/powermail'
    ]:
        return res
    
    soup = BeautifulSoup(requests.get(url).text, 'html.parser')
    info = soup.body
    if info != None:
        # print(info.text)
        res += format_text(info.text)

    return res


if __name__ == '__main__':
    # with open('/Volumes/NVD/experiment_data/datasets/completion/url_list/typo3.org', 'r') as f:
    #     data = f.readlines()

    # for url in data:
    #     url = url.strip()
    #     res = scrapy(url)
    #     print(len(res))

    url = 'https://mantisbt.org/bugs/view.php?id=15453'
    res = scrapy(url)
    print(res)
    # save_text('tp', res)