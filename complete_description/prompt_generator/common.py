import requests
from bs4 import BeautifulSoup

def handleText(input):
    # 以换行符为分隔符，将字符串分割成行
    lines = input.split('\n')

    # 去除每行前后的空格，并过滤掉空行
    stripped_lines = [line.strip() for line in lines if line.strip()]

    # 将处理后的内容合并为一个字符串
    result = '\n'.join(stripped_lines)
    return result

def generate_prompt(url: str):
        
    prompt = '''
I will give you some information about a software vulnerability. You need to extract the valuable parts from the information. The focus is on the information section describing the vulnerability. The information may be very little or invalid. In this case, just output "no results".\n\n'''[1:]

    try:
        res = requests.get(url)
        soup = BeautifulSoup(res.text, 'html.parser')
        info = soup.body
        if info != None:
            # print(info.text)
            prompt += handleText(info.text)
    except Exception:
        return None

    return prompt


if __name__ == '__main__':
    url = 'https://access.redhat.com/articles/2548661'
    prompt = generate_prompt(url)
    if prompt != None:
        with open('./prompt_template/prompt_test/common', 'w') as f:
            print(prompt, file = f)