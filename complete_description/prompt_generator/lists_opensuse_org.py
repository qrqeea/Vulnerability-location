import requests
from bs4 import BeautifulSoup


def generate_prompt(url: str):
    
    prompt = '''
I will give you some information about the content of posts discussing software vulnerabilities. The information includes these parts: title and content, followed by {Title} and {Content} respectively. You need to extract the valuable parts from the information. The focus is on the information section describing the vulnerability. If the content section contains insufficient information to extract valuable details about the vulnerability, the output should be "no results".\n\n'''[1:]

    res = requests.get(url)
    soup = BeautifulSoup(res.text, 'html.parser')

    info = soup.find(name = 'div', attrs = {
        'class' : 'col-10',
    })
    if info != None:
        # print(info.text)
        prompt += '{Title}:' + info.text + '\n'

    info = soup.find(name = 'div', attrs = {
        'class' : 'email-body',
    })
    if info != None:
        # print(info.text)
        prompt += '{Content}:' + info.text

    return prompt

if __name__ == '__main__':
    url = 'https://lists.opensuse.org/archives/list/updates@lists.opensuse.org/message/XNS7IKXJLNCZ7UJNBTQVPZZBSPFQJCS3/'
    prompt = generate_prompt(url)
    if prompt != None:
        with open('./prompt_template/prompt_test/lists.opensuse.org', 'w') as f:
            print(prompt, file = f)
