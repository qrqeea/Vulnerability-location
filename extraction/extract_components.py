import os
from util import query_openai, save_text

def extract_components(source_path: str, target_path: str):
    with open('prompt_template/prompt_extract_components', 'r') as f:
        prompt_template = f.read()

    files = os.listdir(source_path)
    # count = 0
    for file in files:
        # count += 1
        # if count > 20:
        #     break
        with open(f'{source_path}/{file}', 'r') as f:
            # print(file)
            prompt = prompt_template + f.read()
            res = query_openai(prompt)
            save_text(f'{target_path}/{file}', res)