from filter_datasets import filter_datasets
from filter_sub_datasets import filter_sub_datasets
from complete_description import complete_description
from extract_components import extract_components
from get_cpe_products import get_cpe_products
from get_repository import get_repository
from get_commit import get_commit
from get_publiced_date import get_publiced_date
from get_repo_files import get_repo_files


if __name__ == '__main__':
    # cve_list_all = filter_datasets(save_to_file = 'experiment_data/4571/cve_list')
    cve_list = filter_sub_datasets(save_to_file = 'experiment_data/267/cve_list')
    # complete_description(cve_list)
    # extract_components(
    #     'experiment_data/267/completion_description_data/description',
    #     'experiment_data/267/components'
    # )
    cpe_product_dic = get_cpe_products(
        cve_list,
        cpe_json_path = 'experiment_data/all/cpe_json',
        target_path = 'experiment_data/267/{cve: {cpe_products}}'
    )
    cve_and_repo_full_name = get_repository(
        cpe_product_dic = cpe_product_dic,
        target_path = 'experiment_data/267/{(cve, repo_full_name): url}'
    )
    publiced_date = get_publiced_date(
        cve_list = cve_list,
        cpe_json_path = 'experiment_data/all/cpe_json',
        target_path = 'experiment_data/267/{cve: published_date}'
    )
    cve_and_commit = get_commit(
        cve_and_repo_full_name = cve_and_repo_full_name,
        publiced_date = publiced_date,
        target_path = 'experiment_data/267/{(cve, repo_full_name): commit}'
    )
    get_repo_files(
        cve_and_repo_full_name = cve_and_repo_full_name,
        cve_and_commit = cve_and_commit,
    )