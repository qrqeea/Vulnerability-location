from tools.datasets_filter import filter_datasets
from completion.completion import Completion
from repository.RepositoryCollection import RepositoryCollection
from repository.RepositoryClone import RepositoryClone
from commit.CommitCollection import CommitCollection

from util import load_pickle


cve_list = filter_datasets('/Volumes/NVD/experiment_data/all', '/Volumes/NVD/experiment_data/datasets')
completion = Completion(
    '/Volumes/NVD/experiment_data/datasets/completion',
    '/Volumes/NVD/experiment_data/datasets/cve_json',
    cve_list,
    8192,
    16385
)
# completion.start()

# repositoryCollection = RepositoryCollection(
#     '/Volumes/NVD/experiment_data/datasets/repository_collection',
#     '/Volumes/NVD/experiment_data/datasets/cve_json',
#     cve_list
# )
# repositoryCollection.start()

# commitCollection = CommitCollection(
#     '/Volumes/NVD/experiment_data/datasets/commit',
#     '/Volumes/NVD/experiment_data/all/cpe_json',
#     load_pickle('/Volumes/NVD/experiment_data/datasets/repository_collection/repo_collection.pkl')
# )
# commitCollection.start()

repositoryDownload = RepositoryClone(
    '/Volumes/NVD/experiment_data/datasets/repository_clone',
    load_pickle('/Volumes/NVD/experiment_data/datasets/commit/cve_repo_commit.pkl')
)
repositoryDownload.start()