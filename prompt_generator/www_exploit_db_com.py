from selenium import webdriver
from selenium.webdriver.common.by import By
from selenium.webdriver.support.ui import WebDriverWait
from selenium.webdriver.support import expected_conditions as EC


def generate_prompt(url: str):

    prompt = '''
I will give you some information about a software vulnerability. You need to extract the valuable parts from the information. The focus is on the information section describing the vulnerability.\n\n'''[1:]

    driver = webdriver.Chrome()
    driver.get(url)

    element = WebDriverWait(driver, 10).until(
        EC.presence_of_element_located((By.CLASS_NAME, 'row'))
    )

    # content = driver.page_source
    # print(content)

    # prompt += '{Title}: ' + driver.title
    # prompt += '{title}: ' + title + '\n\n'

    content = driver.find_elements(By.CLASS_NAME, 'card')
    if len(content) > 2:
        prompt += content[0].text
        prompt += content[-2].text

    driver.quit()

    return prompt

if __name__ == '__main__':
    url = 'https://www.exploit-db.com/exploits/46488'
    prompt = generate_prompt(url)
    if prompt != None:
        with open('./prompt_template/prompt_test/www.exploit-db.com', 'w') as f:
            print(prompt, file = f)